function main()

I11=imread('1 (1).pgm');    %Subject_1
I12=imread('1 (2).pgm');
I13=imread('1 (3).pgm');
I14=imread('1 (4).pgm');
I15=imread('1 (5).pgm');
I16=imread('1 (6).pgm');
I17=imread('1 (7).pgm');
I18=imread('1 (8).pgm');
I19=imread('1 (9).pgm');
I110=imread('1 (10).pgm');

I21=imread('2 (1).pgm');    %Subject_2
I22=imread('2 (2).pgm');
I23=imread('2 (3).pgm');
I24=imread('2 (4).pgm');
I25=imread('2 (5).pgm');
I26=imread('2 (6).pgm');
I27=imread('2 (7).pgm');
I28=imread('2 (8).pgm');
I29=imread('2 (9).pgm');
I210=imread('2 (10).pgm');


I31=imread('3 (1).pgm');    %Subject_3
I32=imread('3 (2).pgm');
I33=imread('3 (3).pgm');
I34=imread('3 (4).pgm');
I35=imread('3 (5).pgm');
I36=imread('3 (6).pgm');
I37=imread('3 (7).pgm');
I38=imread('3 (8).pgm');
I39=imread('3 (9).pgm');
I310=imread('3 (10).pgm');


I41=imread('4 (1).pgm');    %Subject_4
I42=imread('4 (2).pgm');
I43=imread('4 (3).pgm');
I44=imread('4 (4).pgm');
I45=imread('4 (5).pgm');
I46=imread('4 (6).pgm');
I47=imread('4 (7).pgm');
I48=imread('4 (8).pgm');
I49=imread('4 (9).pgm');
I410=imread('4 (10).pgm');


I51=imread('5 (1).pgm');    %Subject_5
I52=imread('5 (2).pgm');
I53=imread('5 (3).pgm');
I54=imread('5 (4).pgm');
I55=imread('5 (5).pgm');
I56=imread('5 (6).pgm');
I57=imread('5 (7).pgm');
I58=imread('5 (8).pgm');
I59=imread('5 (9).pgm');
I510=imread('5 (10).pgm');


I61=imread('6 (1).pgm');    %Subject_6
I62=imread('6 (2).pgm');
I63=imread('6 (3).pgm');
I64=imread('6 (4).pgm');
I65=imread('6 (5).pgm');
I66=imread('6 (6).pgm');
I67=imread('6 (7).pgm');
I68=imread('6 (8).pgm');
I69=imread('6 (9).pgm');
I610=imread('6 (10).pgm');

I71=imread('7 (1).pgm');    %Subject_7
I72=imread('7 (2).pgm');
I73=imread('7 (3).pgm');
I74=imread('7 (4).pgm');
I75=imread('7 (5).pgm');
I76=imread('7 (6).pgm');
I77=imread('7 (7).pgm');
I78=imread('7 (8).pgm');
I79=imread('7 (9).pgm');
I710=imread('7 (10).pgm');


I81=imread('8 (1).pgm');    %Subject_8
I82=imread('8 (2).pgm');
I83=imread('8 (3).pgm');
I84=imread('8 (4).pgm');
I85=imread('8 (5).pgm');
I86=imread('8 (6).pgm');
I87=imread('8 (7).pgm');
I88=imread('8 (8).pgm');
I89=imread('8 (9).pgm');
I810=imread('8 (10).pgm');


I91=imread('9 (1).pgm');    %Subject_9
I92=imread('9 (2).pgm');
I93=imread('9 (3).pgm');
I94=imread('9 (4).pgm');
I95=imread('9 (5).pgm');
I96=imread('9 (6).pgm');
I97=imread('9 (7).pgm');
I98=imread('9 (8).pgm');
I99=imread('9 (9).pgm');
I910=imread('9 (10).pgm');


I101=imread('10 (1).pgm');    %Subject_10
I102=imread('10 (2).pgm');
I103=imread('10 (3).pgm');
I104=imread('10 (4).pgm');
I105=imread('10 (5).pgm');
I106=imread('10 (6).pgm');
I107=imread('10 (7).pgm');
I108=imread('10 (8).pgm');
I109=imread('10 (9).pgm');
I1010=imread('10 (10).pgm');


I111=imread('11 (1).pgm');    %Subject_11
I112=imread('11 (2).pgm');
I113=imread('11 (3).pgm');
I114=imread('11 (4).pgm');
I115=imread('11 (5).pgm');
I116=imread('11 (6).pgm');
I117=imread('11 (7).pgm');
I118=imread('11 (8).pgm');
I119=imread('11 (9).pgm');
I1110=imread('11 (10).pgm');

I121=imread('12 (1).pgm');    %Subject_12
I122=imread('12 (2).pgm');
I123=imread('12 (3).pgm');
I124=imread('12 (4).pgm');
I125=imread('12 (5).pgm');
I126=imread('12 (6).pgm');
I127=imread('12 (7).pgm');
I128=imread('12 (8).pgm');
I129=imread('12 (9).pgm');
I1210=imread('12 (10).pgm');


I131=imread('13 (1).pgm');    %Subject_13
I132=imread('13 (2).pgm');
I133=imread('13 (3).pgm');
I134=imread('13 (4).pgm');
I135=imread('13 (5).pgm');
I136=imread('13 (6).pgm');
I137=imread('13 (7).pgm');
I138=imread('13 (8).pgm');
I139=imread('13 (9).pgm');
I1310=imread('13 (10).pgm');


I141=imread('14 (1).pgm');    %Subject_14
I142=imread('14 (2).pgm');
I143=imread('14 (3).pgm');
I144=imread('14 (4).pgm');
I145=imread('14 (5).pgm');
I146=imread('14 (6).pgm');
I147=imread('14 (7).pgm');
I148=imread('14 (8).pgm');
I149=imread('14 (9).pgm');
I1410=imread('14 (10).pgm');


I151=imread('15 (1).pgm');    %Subject_15
I152=imread('15 (2).pgm');
I153=imread('15 (3).pgm');
I154=imread('15 (4).pgm');
I155=imread('15 (5).pgm');
I156=imread('15 (6).pgm');
I157=imread('15 (7).pgm');
I158=imread('15 (8).pgm');
I159=imread('15 (9).pgm');
I1510=imread('15 (10).pgm');

% Data Matrix
DataSet= [I11(:) I12(:) I13(:) I14(:) I15(:) I16(:) I17(:) I18(:) I19(:) I110(:) ...
    I21(:) I22(:) I23(:) I24(:) I25(:) I26(:) I27(:) I28(:) I29(:) I210(:) ...
    I31(:) I32(:) I33(:) I34(:) I35(:) I36(:) I37(:) I38(:) I39(:) I310(:) ...
    I41(:) I42(:) I43(:) I44(:) I45(:) I46(:) I47(:) I48(:) I49(:) I410(:) ... 
    I51(:) I52(:) I53(:) I54(:) I55(:) I56(:) I57(:) I58(:) I59(:) I510(:) ...
    I61(:) I62(:) I63(:) I64(:) I65(:) I66(:) I67(:) I68(:) I69(:) I610(:) ...
    I71(:) I72(:) I73(:) I74(:) I75(:) I76(:) I77(:) I78(:) I79(:) I710(:) ...
    I81(:) I82(:) I83(:) I84(:) I85(:) I86(:) I87(:) I88(:) I89(:) I810(:) ...
    I91(:) I92(:) I93(:) I94(:) I95(:) I96(:) I97(:) I98(:) I99(:) I910(:) ...
    I101(:) I102(:) I103(:) I104(:) I105(:) I106(:) I107(:) I108(:) I109(:) I1010(:) ...
    I111(:) I112(:) I113(:) I114(:) I115(:) I116(:) I117(:) I118(:) I119(:) I1110(:) ...
    I121(:) I122(:) I123(:) I124(:) I125(:) I126(:) I127(:) I128(:) I129(:) I1210(:) ...
    I131(:) I132(:) I133(:) I134(:) I135(:) I136(:) I137(:) I138(:) I139(:) I1310(:) ...
    I141(:) I142(:) I143(:) I144(:) I145(:) I146(:) I147(:) I148(:) I149(:) I1410(:) ...
    I151(:) I152(:) I153(:) I154(:) I155(:) I156(:) I157(:) I158(:) I159(:) I1510(:)];

%Representative function
rep1= rep_image(DataSet(:,1:10));  
rep2= rep_image(DataSet(:,11:20));  
rep3= rep_image(DataSet(:,21:30)); 
rep4= rep_image(DataSet(:,31:40)); 
rep5= rep_image(DataSet(:,41:50));  
rep6= rep_image(DataSet(:,51:60));  
rep7= rep_image(DataSet(:,61:70 )); 
rep8= rep_image(DataSet(:,71:80)); 
rep9= rep_image(DataSet(:,81:90));  
rep10= rep_image(DataSet(:,91:100));  
rep11= rep_image(DataSet(:,101:110)); 
rep12= rep_image(DataSet(:,111:120)); 
rep13= rep_image(DataSet(:,121:130)); 
rep14= rep_image(DataSet(:,131:140));  
rep15= rep_image(DataSet(:,141:150)); 

% Checking the images
figure('Name','Representative Images','NumberTitle','off')
subplot(3,5,1),  imshow(uint8(rep1) );  title('SUBJECT 1') 
subplot(3,5,2),  imshow(uint8(rep2));   title('SUBJECT 2')
subplot(3,5,3),  imshow(uint8(rep3));   title('SUBJECT 3')
subplot(3,5,4),  imshow(uint8(rep4));   title('SUBJECT 4')
subplot(3,5,5),  imshow(uint8(rep5));   title('SUBJECT 5')
subplot(3,5,6),  imshow(uint8(rep6));   title('SUBJECT 6')
subplot(3,5,7),  imshow(uint8(rep7));   title('SUBJECT 7')
subplot(3,5,8),  imshow(uint8(rep8));   title('SUBJECT 8')
subplot(3,5,9),  imshow(uint8(rep9));   title('SUBJECT 9')
subplot(3,5,10), imshow(uint8(rep10));  title('SUBJECT 10')
subplot(3,5,11), imshow(uint8(rep11));  title('SUBJECT 11')
subplot(3,5,12), imshow(uint8(rep12));  title('SUBJECT 12')
subplot(3,5,13), imshow(uint8(rep13));  title('SUBJECT 13')
subplot(3,5,14), imshow(uint8(rep14));  title('SUBJECT 14')
subplot(3,5,15), imshow(uint8(rep15));  title('SUBJECT 15')


function im= rep_image(A)   %130 ACCURACY 
    
PH= single(A)- single(mean(A,2)) ;
[U, S, ~] = svd(PH'*PH/size(A,2));
k= -PH*U(:,1)/norm(PH*U(:,1))*(S(1)^0.5) +single(mean(A,2))  ;
im= reshape(k(:),64,64);

end

% function im= rep_image(A)   %149 ACCURACY_ second_method 
%   
% PH= single(A) ;
% [U, S, ~] = svd(PH'*PH/10);
% k= -PH*U(:,1)/norm(PH*U(:,1))*(S(1)^0.5)  ;
% im= reshape(k(:),64,64);
% 
% end

a= accuracy(single(DataSet),[rep1(:) rep2(:) rep3(:) rep4(:) rep5(:) rep6(:) rep7(:) rep8(:) rep9(:) rep10(:) rep11(:) rep12(:) rep13(:) rep14(:) rep15(:)]);

fprintf('The accuracy of the algorithm is %d(out of 150) \n',a);

end
function a= accuracy(D,R)
R= single(R);
index= zeros(size(D,2),1);

    for in=1:size(D,2)
        c=zeros(15,1);
        for i=1:size(R,2)
            c(i)= norm(R(:,i)-D(:,in));       
        end
       [~,index(in)]= min(c);
    end
    
index=reshape(index,10,15);
a=0;                                % Accuracy
    for j=1:15
       a=a+ sum(index(:,j)==j);   
    end

end

